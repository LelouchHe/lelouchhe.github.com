---
layout: post
title: TCPIP详解卷一 第一章
category: network
tag: illustrated
---

## 分层协议

有一张图很好的表达分层协议的地位和作用

![分层协议][layer]

从下自上分别为:

* **链路层**: 这层出现的主要目的在于集中处理各自物理链路层面上的通讯问题,图上我们可以看到,现实中存在多种网络连接的物理实现(像图中的以太网和令牌环,后文介绍的slip和ppp等),每个层次要处理的物理通讯都非常不同,但又非常细节,需要一些抽象通用的功能实现,这些都是在链路层进行处理,他们屏蔽了各自的物理实现.唯一要注意的是,链路层只处理一种物理连接实现,以太网的只负责以太网的通讯功能,令牌环的也只负责令牌环的通讯,不能跨域来进行通讯
* **网络层**: 链路层无法跨域,所以就引入了其上的网络层(其中著名的ip协议),网络层的一个作用就是屏蔽掉不同网络物理实现的不同,通过一个抽象的ip地址来代表通信线路(就是**网络**)上的一点,而不关心实际物理地址,或者实际通讯细节如何.这层的存在是非常必要的,相当于对通讯封装了统一接口,我们之上的工作只需要在这个抽象之上来做即可.从目前来看,这个抽象很成功
* **传输层**: 网络层对网络通讯的点做了抽象,屏蔽掉了点与点之间的连接细节,但是此时的通讯仍然处在**临近点**之间(链路层处理统一物理网络中A到B的通讯,网络层处理逻辑网络中A到B的通讯),这样就引入了传输层(tcp/udp)来抽象真正通讯双方的连接,此时的通讯双方,不再局限于临近,而是真真正正的在网络上的任意两点.可以想到,传输层定义的,肯定是如果从临近的两点信息中,找到S到D的一条网络通路,并通过抽象的网络层,将真正的通讯内容,传递过去(可以看到,没有网络层,这是多么的难做成).之所以有两种通用协议实现,主要还是在于不同的使用情境.tcp保证质量,但通讯繁杂;udp保证速度,但质量堪忧,而且如果自行实现来保证udp的可靠,无异于自行实现tcp栈.所以在平时使用中,尽量使用tcp
* **应用层**: 解决了统一逻辑网络任意两点间的通讯问题之后,剩下的问题基本就是应用问题了.设计怎样的协议,如何通讯,如何响应,虽然在这一层同样有一些模式可循,但都是应用程序自己的事情了,打包好数据,剩下了事情就被传输层屏蔽了

其实看来,就解决的通讯问题而言,链路层是"物理网络相邻两点", 网络层是"逻辑网络相邻两点",传输层是"逻辑网络任意两点",应用层则是"通讯内容和通讯方式"

## tcp/ip协议族

逻辑上的分层协议,在实现上同样有类似的结构,将各个分层一一匹配,有下图:

![协议族][protocol]

自下而上对应的协议有:

1. ARP/RARP: 这两个协议一个负责将ip地址









[layer]: /image/tcp_ip_layer.png "分层协议"
[protocol]: /image/tcp_ip_protocol.png "协议族"
